import{d as ne,l as re,z as c,m as z,ah as de,am as se,L as S,o as r,c as m,b as t,w as o,a as M,J as v,u as i,A as b,f as g,t as w,an as V,ao as ue,ap as I,aq as ie,K as N,ad as pe,ar as ce,as as me,h as _e,a9 as fe,at as ve,au as we,av as he,aw as ge,ax as ye,aj as ke,ay as xe,S as q,_ as be}from"./index-59vPsdGi.js";/* empty css                *//* empty css                      *//* empty css                        */const Ve={class:"tool"},Ce={class:"left"},Ye={class:"right"},De={key:1},Ue={key:1},Se={key:1},Me={key:1},Ee={key:1},Te={key:1},Be={key:0},He={key:1},Re=ne({__name:"index",setup(ze){const C=re(),E=c();let d=c(""),_=c("未完成"),s=c([]),h=c(1),f=c(10),A=z(()=>s.value.length);const O=z(()=>{const a=(h.value-1)*f.value,l=a+f.value;return s.value.slice(a,l)}),P=a=>{h.value=a},j=a=>{f.value=a};de(()=>{C.getUserInfo(),Y(_.value)});const J=c(),L=(a,l)=>l.done===a,K=()=>{d.value="",Y(_.value)},Y=async a=>{await se().then(l=>{switch(a){case"全部":s.value=l;break;case"已完成":s.value=l.filter(u=>u.done===!0);break;case"未完成":s.value=l.filter(u=>u.done===!1);break;default:s.value=l.filter(u=>u.done===!1)}},l=>{S({type:"error",message:"获取全部任务信息失败 "+l})})},k=async a=>{await xe(s.value).then(()=>{S({type:"success",message:a+"成功 "})},l=>{S({type:"error",message:a+"失败 "+l})})},$=()=>{d.value="",s.value.unshift({id:ue.v4(),add:C.shortId,allDay:!0,title:"",textarea:"",start:I().format("YYYY-MM-DD 00:00"),end:I().format("YYYY-MM-DD 00:00"),color:ie(),textColor:"#000000",isRrule:!1,done:!1,confirm:"",rrule:{freq:"",dtstart:"",until:"",interval:0,byweekday:[]}}),k("添加")};let T=c();const F=a=>{T.value=JSON.parse(JSON.stringify(a.row)),d.value=a.row.id,q(()=>{E.value.focus()})},Q=a=>{Object.assign(a.row,{...T.value}),d.value=""},G=()=>{console.log("1",s.value),k("保存"),console.log("2",s.value),d.value="",q(()=>{})},W=a=>{N({title:"提示",message:`确认删除该数据?<br/>任务标题：${a.row.title}`,dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(()=>{s.value.splice(a.$index,1),k("删除")}).catch(()=>{})};let D=c([]);const X=a=>{D.value=a},Z=()=>{N({title:"提示",message:"确认删除选中的数据?",dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(()=>{s.value=s.value.filter(a=>!D.value.some(l=>a.id===l.id)),k("删除")}).catch(()=>{})},B=a=>{d.value!==""&&d.value!==a.id&&(d.value="",Y(_.value))};let x=c("");return(a,l)=>{const u=pe,y=ce,H=me,ee=_e,U=fe,p=ve,R=we,te=he,ae=ge,le=ye,oe=ke;return r(),m("div",null,[t(oe,{style:{margin:"10px 0px"}},{default:o(()=>[M("div",Ve,[M("div",Ce,[t(u,{type:"primary",onClick:$},{default:o(()=>[v("添加任务")]),_:1}),t(u,{type:"primary",disabled:!i(D).length,onClick:Z},{default:o(()=>[v(" 删除选中 ")]),_:1},8,["disabled"]),t(H,{class:"select",type:"primary",modelValue:i(_),"onUpdate:modelValue":l[0]||(l[0]=e=>b(_)?_.value=e:_=e),placeholder:"Select",onChange:K},{default:o(()=>[t(y,{label:"全部",value:"全部"}),t(y,{label:"已完成",value:"已完成"}),t(y,{label:"未完成",value:"未完成"})]),_:1},8,["modelValue"])]),M("div",Ye,[t(U,{modelValue:i(x),"onUpdate:modelValue":l[1]||(l[1]=e=>b(x)?x.value=e:x=e),placeholder:"搜索标题"},{append:o(()=>[t(u,null,{default:o(()=>[t(ee,{name:"Search"})]),_:1})]),_:1},8,["modelValue"])])]),t(ae,{ref_key:"tableRef",ref:J,style:{margin:"10px 0px"},data:O.value,onSelectionChange:X,onRowClick:B,onRowContextmenu:B,"highlight-current-row":"",border:""},{default:o(()=>[t(p,{type:"selection",fixed:"left"}),t(p,{label:"#",type:"index"}),t(p,{label:"ID",prop:"id","show-overflow-tooltip":"",width:"50px"}),t(p,{label:"添加人",prop:"add","show-overflow-tooltip":"",width:"70px"}),t(p,{label:"任务标题",prop:"title","show-overflow-tooltip":""},{default:o(e=>[e.row.id==i(d)?(r(),g(U,{key:0,ref_key:"refInput",ref:E,modelValue:e.row.title,"onUpdate:modelValue":n=>e.row.title=n},null,8,["modelValue","onUpdate:modelValue"])):(r(),m("span",De,w(e.row.title),1))]),_:1}),t(p,{label:"任务描述",prop:"textarea","show-overflow-tooltip":""},{default:o(e=>[e.row.id==i(d)?(r(),g(U,{key:0,type:"textarea",modelValue:e.row.textarea,"onUpdate:modelValue":n=>e.row.textarea=n},null,8,["modelValue","onUpdate:modelValue"])):(r(),m("span",Ue,w(e.row.textarea),1))]),_:1}),t(p,{label:"开始时间",prop:"start","show-overflow-tooltip":"",align:"center",width:"170px",sortable:""},{default:o(e=>[e.row.id==i(d)?(r(),g(R,{key:0,modelValue:e.row.start,"onUpdate:modelValue":n=>e.row.start=n,type:"datetime",placeholder:"选择时间日期",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm",style:{width:"100%"},editable:!1},null,8,["modelValue","onUpdate:modelValue"])):(r(),m("span",Se,w(e.row.start),1))]),_:1}),t(p,{label:"结束时间",prop:"end","show-overflow-tooltip":"",align:"center",width:"170px",sortable:""},{default:o(e=>[e.row.id==i(d)?(r(),g(R,{key:0,modelValue:e.row.end,"onUpdate:modelValue":n=>e.row.end=n,type:"datetime",placeholder:"选择时间日期",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):(r(),m("span",Me,w(e.row.end),1))]),_:1}),t(p,{label:"任务进度",prop:"done","show-overflow-tooltip":"",align:"center",width:"120px","column-key":"done",filters:[{text:"已完成",value:!0},{text:"未完成",value:!1}],"filter-method":L,"filter-multiple":!1},{default:o(e=>[e.row.id==i(d)?(r(),g(H,{key:0,modelValue:e.row.done,"onUpdate:modelValue":n=>e.row.done=n},{default:o(()=>[t(y,{label:"已完成",value:!0}),t(y,{label:"未完成",value:!1})]),_:2},1032,["modelValue","onUpdate:modelValue"])):(r(),m("span",Ee,w(e.row.done?"已完成":"未完成"),1))]),_:1}),t(p,{label:"确认人",prop:"confirm","show-overflow-tooltip":"",width:"70px"},{default:o(e=>[e.row.done?(r(),g(te,{key:0,modelValue:e.row.confirm,"onUpdate:modelValue":n=>e.row.confirm=n},{default:o(()=>[v(w(i(C).shortId),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(r(),m("span",Te,w(),1))]),_:1}),t(p,{label:"操作",width:"160px",align:"center",fixed:"right"},{default:o(e=>[e.row.id==i(d)?(r(),m("div",Be,[t(u,{type:"primary",onClick:l[2]||(l[2]=V(n=>G(),["prevent"]))},{default:o(()=>[v(" 保存 ")]),_:1}),t(u,{onClick:V(n=>Q(e),["prevent"])},{default:o(()=>[v("取消")]),_:2},1032,["onClick"])])):(r(),m("div",He,[t(u,{type:"primary",onClick:V(n=>F(e),["prevent"])},{default:o(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),t(u,{type:"danger",onClick:V(n=>W(e),["prevent"])},{default:o(()=>[v(" 删除 ")]),_:2},1032,["onClick"])]))]),_:1})]),_:1},8,["data"]),t(le,{"current-page":i(h),"onUpdate:currentPage":l[3]||(l[3]=e=>b(h)?h.value=e:h=e),"page-size":i(f),"onUpdate:pageSize":l[4]||(l[4]=e=>b(f)?f.value=e:f=e),"page-sizes":[10,20,50],layout:"prev, pager, next, jumper,->,sizes,total",total:i(A),background:"",onCurrentChange:P,onSizeChange:j},null,8,["current-page","page-size","total"])]),_:1})])}}}),Oe=be(Re,[["__scopeId","data-v-d1aa0f3a"]]);export{Oe as default};
