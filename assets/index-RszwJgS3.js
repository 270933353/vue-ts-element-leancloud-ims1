import{d as z,a0 as A,k as H,I as K,z as g,l as T,a3 as E,r as J,o as j,c as G,b as e,w as t,a as n,t as v,u as a,J as y,a4 as M,F as O,a5 as Q,a6 as p,a7 as S,a8 as W,h as X,E as Y,a9 as Z,C as ee,aa as se,ab as te,ac as oe,ad as ae,D as le,ae as re,af as ne,_ as ie}from"./index-59vPsdGi.js";import{v as ue}from"./validator-qMdRg1PI.js";const de=_=>(re("data-v-f12e294d"),_=_(),ne(),_),pe={class:"form-title"},me={class:"remember"},ce={class:"other-login"},_e=de(()=>n("div",{class:"divider"},[n("span",{class:"line"}),n("span",{class:"divider-text"},"其它登录方式"),n("span",{class:"line"})],-1)),fe={class:"other-login-wrapper"},ge={class:"other-login-item"},ve={class:"other-login-item"},he={class:"other-login-item"},we=z({__name:"index",setup(_){const{t:b}=A(),$=H(),f=K();let h=g(),u=g(!0),m=g(!1),x=T(),w=g(),s=E({username:"",password:"",remember:!1,sliderPass:!1}),C=E({username:[{required:!0,message:b("validator.inputUsername"),trigger:"blur"}],password:[{required:!0,message:b("validator.inputPassword"),trigger:"blur"}],sliderPass:[{validator:ue,trigger:"blur"}]});const P=()=>{if(s.remember){if(s.password.trim()===""){let l=localStorage.getItem(s.username);l?(u.value=!1,s.password=Q(l)):u.value=!0}}else u.value=!0,s.password=""},F=()=>{s.remember=!1,u.value=!0},R=()=>{s.remember=!1,u.value=!0},I=l=>{l&&l.validate(async o=>{o?(m.value=!0,await x.userLogin(s).then(()=>{const r=$.query.redirect;f.push({path:r||"/"}),f.push("/"),p({title:`Hi，${S()}好 ⛅`,type:"success",message:"欢迎登录"}),s.remember?localStorage.setItem(s.username,W(s.password)):localStorage.removeItem(s.username),m.value=!1},r=>{r.code===210||r.code===211?p({title:"登录失败",type:"error",message:"账号或密码错误"}):p({title:"登录失败",type:"error",message:r.code+" "+r}),m.value=!1,s.sliderPass=!1,h.value.reset()})):(p({title:"表单校验失败",type:"error"}),m.value=!1,s.sliderPass=!1,h.value.reset())})},U=()=>{x.userLogin({username:"Visitor",password:"Visitor"}).then(()=>{f.push({path:"/"}),p({title:`Hi，${S()}好 ⛅`,type:"success",message:"欢迎登录",duration:1500})},l=>{p({title:"登录失败",type:"error",message:l})})};return(l,o)=>{const r=X,d=Y,V=Z,c=ee,q=se,L=te,B=J("router-link"),N=oe,k=ae,D=le;return j(),G(O,null,[e(D,{ref_key:"loginFormRef",ref:w,size:"large",model:a(s),rules:a(C),onKeyup:o[6]||(o[6]=M(i=>I(a(w)),["enter"]))},{default:t(()=>[n("div",pe,[n("span",null,v(l.$t("login.title")),1)]),e(c,{prop:"username"},{default:t(()=>[e(V,{type:"text",modelValue:a(s).username,"onUpdate:modelValue":o[0]||(o[0]=i=>a(s).username=i),placeholder:l.$t("login.username"),autocomplete:"off",clearable:"",onInput:F},{prefix:t(()=>[e(d,null,{default:t(()=>[e(r,{name:"User"})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),e(c,{prop:"password",style:{margin:"10px 0px"}},{default:t(()=>[e(V,{type:"password",modelValue:a(s).password,"onUpdate:modelValue":o[1]||(o[1]=i=>a(s).password=i),placeholder:l.$t("login.password"),autocomplete:"off","show-password":a(u),clearable:"",onInput:R},{prefix:t(()=>[e(d,null,{default:t(()=>[e(r,{name:"Lock"})]),_:1})]),_:1},8,["modelValue","placeholder","show-password"])]),_:1}),n("div",me,[e(q,{label:"自动登录",modelValue:a(s).remember,"onUpdate:modelValue":o[2]||(o[2]=i=>a(s).remember=i),onChange:P},null,8,["modelValue"]),e(B,{replace:"",to:"/account/forget"},{default:t(()=>[e(L,{underline:!1,type:"primary"},{default:t(()=>[y(v(l.$t("login.forget")),1)]),_:1})]),_:1})]),e(c,{prop:"sliderPass"},{default:t(()=>[e(N,{ref_key:"slideVerifyRef",ref:h,value:a(s).sliderPass,"onUpdate:value":o[3]||(o[3]=i=>a(s).sliderPass=i)},null,8,["value"])]),_:1}),e(c,null,{default:t(()=>[e(k,{class:"form-button",type:"primary",loading:a(m),onClick:o[4]||(o[4]=i=>I(a(w)))},{default:t(()=>[y(v(l.$t("login.login")),1)]),_:1},8,["loading"])]),_:1}),e(c,null,{default:t(()=>[e(k,{class:"form-button",onClick:o[5]||(o[5]=i=>a(f).push("/account/signup"))},{default:t(()=>[y(v(l.$t("login.signup")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"]),n("div",ce,[_e,n("div",fe,[n("div",{title:"访客登录",class:"other-login-item",onClick:U},[e(d,{class:"other-login-icon"},{default:t(()=>[e(r,{name:"visitor",width:"33px",height:"33px"})]),_:1})]),n("div",ge,[e(d,null,{default:t(()=>[e(r,{name:"wechat",width:"33px",height:"33px"})]),_:1})]),n("div",ve,[e(d,null,{default:t(()=>[e(r,{name:"qq",width:"33px",height:"33px"})]),_:1})]),n("div",he,[e(d,null,{default:t(()=>[e(r,{name:"alipay",width:"33px",height:"33px"})]),_:1})])])])],64)}}}),xe=ie(we,[["__scopeId","data-v-f12e294d"]]);export{xe as default};
